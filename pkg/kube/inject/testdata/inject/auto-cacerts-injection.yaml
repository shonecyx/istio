apiVersion: apps/v1
kind: Deployment
metadata:
  name: auto-cacerts-injection
spec:
  replicas: 1
  selector:
    matchLabels:
      app: auto-cacerts-injection
  template:
    metadata:
      labels:
        app: auto-cacerts-injection
      annotations:
        application.tess.io/app-container-name: dummy-app-1
        application.tess.io/stackId: raptor.marketplace
        application.tess.io/sidecars-stackId: '{ "dummy-app-2": "nodejs.marketplace"}'
        proxy.istio.io/config: '{ "proxyMetadata": {"INJECT_AUTO_CERT": "true"}}'
    spec:
      containers:
        - name: dummy-app-1
          image: "fake.docker.io/google-samples/hello-go-gke:1.0"
          ports:
            - name: http
              containerPort: 80
 
        - name: dummy-app-2
          image: "fake.docker.io/google-samples/hello-go-gke:1.0"
          ports:
            - name: http
              containerPort: 90              
 
